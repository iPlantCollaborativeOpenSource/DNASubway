    	<div id="home_map">
		  <div id="map_left">
			<span id="map_spacer">
% if ($s->{logged_in} && $s->{new_user}) {
			<div id="startHere"></div>
% }
			</span>
     		<span class="bt_redStart"><a href="<% $s->{logged_in} ? "/project/create_project.html" : "#" %>" class="Start"><span class="Starttip"><span class="top"></span><span class="middle">Input a DNA sequence of up to 100,000 nucleotides to identify the genes and transposons in it, and annotate (associate) the sequence with this information.</span><span class="bottom"></span></span></a></span>
			<span class="bt_yellowStart"><a href="<% $s->{logged_in} ? "/project/target/create" : "#" %>" class="Start"><span class="Starttip"><span class="top"></span><span class="middle">Input a gene or protein of up to 10,000 nucleotides or amino acids to identify related genes, determine gene functions, and build phylogenetic trees.</span><span class="bottom"></span></span></a></span>
		    <span class="bt_blueStart"><a href="#" class="Start"><span class="Starttip"><span class="top"></span><span class="middle">Input a set of Expressed Sequence Tags (ESTs) of up to 100 megabytes of assembled data to determine the potential natures of the genes captured.</span><span class="bottom"></span></span></a></span> 
		  </div>
                
		  		<div id="map_right">
                 <div class="containerHoz">
    <ul class="rolloverMap">
    
    <li><span class="spacer1"></span></li>
    <li><span class="conConsole_info"><a href="#" class="info"><span class="infotip"><span class="top"></span><span class="middle">
	Identify and mask repeats and transposons that can obstruct sequence analysis.
	</span><span class="bottom"></span></span></a></span></li>
    <li><span class="spacer3"></span></li>
    <li><span class="conConsole_info"><a href="#" class="info"><span class="infotip"><span class="top"></span><span class="middle">
	Identify DNA patterns typical for genes using gene prediction algorithms Augustus, FGenesH, SNAP, and tRNA Scan.
	</span><span class="bottom"></span></span></a></span></li>
    <li><span class="spacer3"></span></li>
    <li><span class="conConsole_info"><a href="#" class="info"><span class="infotip"><span class="top"></span><span class="middle">
	Search the sequence for matches to known genes and proteins using search algorithms BLASTN and BLASTP.
	</span><span class="bottom"></span></span></a></span></li>
    <li><span class="spacer3"></span></li>
    <li><span class="conConsole_info"><a href="#" class="info"><span class="infotip"><span class="top"></span><span class="middle">
	Synthesize gene predictions and search results into gene models using the annotation editor Apollo.
	</span><span class="bottom"></span></span></a></span></li>
    </ul>
 	</div><!--END of CLASS containerHoz-->
    
    
    <div class="containerHoz">
    <ul class="rolloverMap">
    
    <li><span class="spacer1"></span></li>
    <li><span class="spacer2"></span></li>
    <li><span class="conConsole_info"><a href="#" class="info"><span class="infotip"><span class="top"></span><span class="middle">
	Search genomes for matches to a gene using search algorithms BLASTN or TBLASTN.
	</span><span class="bottom"></span></span></a></span></li>
    <li><span class="spacer2"></span></li>
    <li><span class="spacer2"></span></li>
    <li><span class="conConsole_info"><a href="#" class="info"><span class="infotip"><span class="top"></span><span class="middle">
	View BLAST search results in multiple alignment format and as tree view.
	</span><span class="bottom"></span></span></a></span></li>
    <li><span class="spacer1"></span></li>
    <li><span class="spacer2"></span></li>
    <li><span class="conConsole_info"><a href="#" class="info"><span class="infotip"><span class="top"></span><span class="middle">
	View analysis results and annotations in a genome browser. Transfer a gene to the Gene Family track (Yellow Line) to identify related genes, determine gene functions, and build phylogenetic trees.
	</span><span class="bottom"></span></span></a></span></li>
 
    </ul>
 	</div><!--END of CLASS containerHoz-->
    
    
    
      <div class="containerHoz">
    <!--<ul class="rolloverMap">
    <li><span class="spacer1"></span></li>
    <li><span class="spacer2"></span></li>
    <li><span class="spacer2"></span></li>
    <li><span class="conConsole_info"><a href="#" class="info"><span class="infotip"><span class="top"></span><span class="middle">Definition about this step will be here. Thank you for your patience.</span><span class="bottom"></span></span></a></span></li>
     </ul>-->

	<span class="spacer1"></span>
    <span class="spacer2"></span>
    <span class="spacer2"></span>
    <span class="conConsole_info"><a href="#" class="info"><span class="infotip"><span class="top"></span><span class="middle">
	Search genome sequences for matches to EST data using DNA search algorithm BLAT.
	</span><span class="bottom"></span></span></a></span>
 
 	</div><!--END of CLASS containerHoz-->
                 
 		  </div> <!--END of ID map_right -->
     
	  </div><!--END of ID home_map-->
    
    
    <div id="home_intro" class="container_text">This site ties together key bioinformatics tools and databases used to annotate genes and 
analyze genome data.  Roll over any of the “stations” on the subway map to find out more about the analysis steps. Start a project by selecting one of the three “subway lines” 
(red, yellow, blue). Register and login if you want to save or share your results.</div>

%#-------------------------------------------------------------------
<%args>
	$name => ''
	$passw => ''
	$guest => ''
	$login => ''
</%args>
%#-------------------------------------------------------------------
<%once>
	use DNALC::Pipeline::Utils qw/random_string/;
	use DNALC::Pipeline::User ();
	use Time::Duration qw/duration/;
</%once>
%#-------------------------------------------------------------------
<%init>
$m->session->{pipeline} ||= { username => "", logged_in => 0};
my $s = $m->session->{pipeline};

#print STDERR "name = $name//sess =$s->{username} \n";

my @err = ();

if ($r->method eq "POST") {

	my $user;

	if ($guest) {
		unless ($name) {
			my $rand = lc random_string(6, 8);
			$name = "guest_$rand";

			print STDERR "Generated user: ", $name, $/;
			$user = eval {
					DNALC::Pipeline::User->create({
						username => $name,
						name_first => "Guest",
						name_last => ucfirst $rand,
						email => '',
						password => random_string(8,8)
					});
				};
			if ($@) {
				push @err, $@;
			}
		}
		elsif ($name =~ /^guest_/) {
			($user) = DNALC::Pipeline::User->search(username => $name);
		}
	}
	else {
		($user) = DNALC::Pipeline::User->search(username => $name);
		$s->{username} = $name;
		unless ($user && $user->password_valid($passw)) {
			$user = undef;
		}
	}
	if ($user) {
		$s->{username} = $user->username;
		$s->{full_name} = $user->full_name;
		$s->{user_id} = $user->id;
		$s->{logged_in} = 1;

		if ($user->has_projects) {
			$m->redirect("/project/browsemy");
		}
		else {
			$s->{new_user} = 1;
			$m->redirect("/");
		}
	}
	else {
		if ($name =~ /^guest_/) {
			$s->{username} = '';
		}
		$m->comp("/_message_add", "Unable to log you in. Try again.");
		$m->redirect("/");
	}
}
else {
	#print STDERR "GET username = ", $s->{username}, $/;
}

</%init>
%#-------------------------------------------------------------------

