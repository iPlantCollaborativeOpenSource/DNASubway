
<div id="conTop_button"> 
	<div id="conTop_title"><h2>PROJECTS</h2></div>
		<div id="conTop_menu">
			<ul id="conTop_menu">
			<li><a href="/project/create_project.html" title="">New Project</a></li>
			<!--<li><a href="#" title="">My Projects</a></li>-->
			<li><a href="./browse" title="" class="current">Public Projects</a></li>
			</ul> 
		</div>
	<div id="conMember_name">USER: Cornel Ghiban</div>	
</div>

<div>BLaBLaBLaBLa 
	<br/><br/> Search BOX &amp; Sort By BOX will be here....
</div>

<div id="container_mytablehome">
  <table class="conProject_table" summary="">
  <tr>
    <th width="49" scope="col">#</th>
    <th width="94" scope="col">Date</th>
    <th width="279" scope="col">Project Title</th>
    <th width="264" scope="col">Organism</th>
    <th width="120" scope="col">Classification</th>
    <th width="62" scope="col">Status</th>
  </tr>
% for (@projects) {
%	my $created = DNALC::Pipeline::App::Utils->format_datetime($_->created, undef, "%m/%d/%Y");
<tr>
	<td><% $_->id %></td>
	<td><% $created %></td>
	<td><a href="/project/console.html?pid=<% $_->id %>"><%$_->name%></a></td>
	<td><% $_->organism %>, <% $_->common_name %></td>
	<td><% $clades{$_->clade}  %></td>
	<!--<td><% $_->user_id %></td>-->
	<td> public </td>
</tr>
% }

</table>

<& '/_pager', cur=>$page, pages => $pages, 
	suffix => '', prefix => '/project/browse/' &>

</div>

%#--------------------------------------------------------
<%args>
	$page => 1
	$sort => 'created desc'
</%args>
<%once>
	use DNALC::Pipeline::Project ();
	use DNALC::Pipeline::User ();
	use DNALC::Pipeline::Config ();
	use DNALC::Pipeline::Utils qw(random_string);
	use DNALC::Pipeline::App::Utils ();
	use Data::Dumper;

	my %clades = (
			d => 'Eudicotyledons',
			m => 'Monocotyledons',
			u => 'Undefined',
			o => 'Other'
		);

	my $epp = 10;
</%once>

<%init>
#my $pcf = DNALC::Pipeline::Config->new->cf('PIPELINE');
$r->content_type('text/html');

$m->session->{pipeline} ||= {};
my $s = $m->session->{pipeline};

if ($r->uri =~ /\/(\d+)$/) {
	$page = $1;
}

unless ($page =~ /^\d+$/) {
	$page = 1;
}

my $orderby = [$sort];

my $pager = DNALC::Pipeline::Project->pager;
$pager->per_page( $epp );
$pager->page( $page );
$pager->order_by( $sort );

my @projects = $pager->search_where;
my $pages = int($pager->total_entries/$epp) + ($pager->total_entries % $epp > 0 ? 1 : 0);
#print STDERR Dumper( $pager ), $/;

</%init>

%#---------------------------------
<%attr>
	js => []
</%attr>
%#---------------------------------

%# vim: ft=mason
