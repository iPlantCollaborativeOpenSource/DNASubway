{status:'<% $status|js%>', message:'<% $msg |js%>'}
<%args>
	$pid => 0
</%args>
<%once>
	use DNALC::Pipeline::App::Phylogenetics::ProjectManager ();
	#use DNALC::Pipeline::Phylogenetics::Pair ();
</%once>
<%init>
	my ($status, $msg) = ("error", "");
	my $pm = DNALC::Pipeline::App::Phylogenetics::ProjectManager->new($pid);
	my $proj = $pm->project;
	unless ($proj) {
		$msg = "Project not found."
	}
	else {
		my $phyi_file = $pm->get_alignment('phyi');

		print STDERR "Alignment file to use: $phyi_file\n";

		my $dist_file = $pm->compute_dist_matrix;
		print STDERR "Dist matrix file to use: $dist_file\n";
		if (-f $dist_file) {
			my $stree = $pm->compute_tree($dist_file);
			print STDERR  "Tree = ", $stree->{tree}, "\t", $stree->{tree_file}, $/;
			$pm->set_task_status("phy_tree", "done");
			$status = "success";
		}
	}
</%init>

<%flags>
	inherit => undef
</%flags>