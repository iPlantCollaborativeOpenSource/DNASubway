% for my $repl (1 .. $repl_num) {
%	my $id = $element->{id};
%	$id =~ s/\d$/$repl/;
<select class="<% $class %>" id="<% $id %>" name="<% $id %>">
<option value="">-= Choose file =-</option>
%		for (@files) {
%	my $sel = defined $user_value && $user_value eq $_->id ? q{selected="selected"} : "";
	<option value="<% $_->id %>" <% $sel %>><% $_->trimmed_file ? $_->trimmed_file->file_name : $_->file_name |html %></option>
% 		}
</select>
&nbsp;
% }
<%args>
	$pm => undef
	$element => undef
	$user_value => undef
	$class => ''
	$filter => undef;
	$input_files_only => undef
</%args>
<%init>
	return unless $pm && $element;
	
	# TODO find a way to get this number from the local app config
	my $repl_num = 2;
	
	my @files = $input_files_only ? grep {$_->is_input} $pm->data : $pm->data;
	@files = grep {$_->file_name =~ /$filter/ && !$_->is_local} @files if $filter;
	
	#use Data::Dumper;
	#print STDERR Dumper($user_value);
	#print STDERR Dumper($element);
</%init>